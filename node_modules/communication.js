const communication = {
	sendAll: (clients, game, payload) =>
	{
		// this is to send the same thing to all clients in the game - whether it's a broadcasted message or
		// score results or whatever. Most of the functions in this module filter back to this one.
		game.clients.forEach (c => {
			clients[c.clientId].connection.send(JSON.stringify(payload));
		})
	},
	chat: (clients, game, clientId, nick, message) =>
	{
		const payload = {
			"method" : "chatmsg",
			"clientId": clientId, 
			"nick": nick,
			"message": message
		}
		communication.sendAll(clients, game, payload)
	},
	broadcast: (clients, game, message) =>
	{
		const payload = {
			"method" : "broadcast",
			"message": message
		}
		communication.sendAll(clients, game, payload)
	},
	dm: (clients, clientId, msg) =>
	{
		const payload = {
			"method" : "dm",
			"message": msg
		}
		console.log("sending " + msg + " to " + clientId);
		clients[clientId].connection.send(JSON.stringify(payload));
	}
}	
module.exports = communication