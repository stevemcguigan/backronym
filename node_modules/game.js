const utils = require('utils')
const communication = require('communication')
const game = {
	create: (clients, games, result) =>
	{
		const clientId = result.clientId;
		const host = result.host;
		const isPrivate = result.isPrivate;
		let key = "";
		const gameId = utils.guid();
		if (isPrivate)
		{	
			for (let x = 0; x < 3; x++)
			{
				x ? key += "-" + dictionary.getRandomWord() : key = dictionary.getRandomWord();
			}	
			keys[key] = gameId; 

		} else {
			key = false
		}	
		console.log(`the game is private? ${isPrivate}. the KEY is ${key}`);

		games[gameId] = {
			"id": gameId,
			"hostId": clientId,
			"hostname": host,
			"key": key,
			"inProgress" : false,
			"clients": [],
			"acronyms": [],
			"currentRound": 1,
			"roundTimer" : null,
			"acceptingAnswers" : false,
			"answers": [],
			"joinable": true
		}

		const payload = {
			"method": "create",
			"game" : games[gameId]
		}

		communication.send(clients[clientId], payload)
		/*const con = clients[clientId].connection;
		con.send(JSON.stringify(payload));*/
	}
}

module.exports = game